<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Device Mapper - Dashboard</title>
    <link rel="stylesheet" href="/css/cyberpunk.css">
    <link rel="stylesheet" href="/css/animations.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-brand glitch">NETWORK DEVICE MAPPER</div>
        <div style="display: flex; align-items: center; gap: 2rem;">
            <span style="color: var(--text-secondary);">Welcome, <span id="username" style="color: var(--neon-cyan);"></span></span>
            <button id="logoutBtn" class="btn btn-danger">Logout</button>
        </div>
    </nav>

    <div class="container">
        <!-- Stats Cards -->
        <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin: 2rem 0;">
            <div class="stat-card fade-in">
                <div class="stat-value" id="totalDevices">0</div>
                <div class="stat-label">Total Devices</div>
            </div>
            <div class="stat-card fade-in" style="animation-delay: 0.1s;">
                <div class="stat-value" id="activeDevices">0</div>
                <div class="stat-label">Active Devices</div>
            </div>
            <div class="stat-card fade-in" style="animation-delay: 0.2s;">
                <div class="stat-value" id="highRiskDevices">0</div>
                <div class="stat-label">High Risk Devices</div>
            </div>
            <div class="stat-card fade-in" style="animation-delay: 0.3s;">
                <div class="stat-value" id="criticalFindings">0</div>
                <div class="stat-label">Critical Findings</div>
            </div>
        </div>

        <!-- Scan Controls -->
        <div class="card slide-in-left" style="margin-bottom: 2rem;">
            <h2 style="margin-bottom: 1.5rem;">Network Scan</h2>
            <div class="grid" style="grid-template-columns: 2fr 1fr 1fr; gap: 1rem; align-items: end;">
                <div>
                    <label class="label" for="networkInput">Network CIDR</label>
                    <input
                        type="text"
                        id="networkInput"
                        class="input-field"
                        placeholder="192.168.1.0/24"
                        value="192.168.1.0/24"
                    >
                </div>
                <div>
                    <label class="label" for="scanProfile">Scan Profile</label>
                    <select id="scanProfile" class="input-field">
                        <option value="quick">Quick (Top 100 ports)</option>
                        <option value="standard" selected>Standard (Top 1000 ports)</option>
                        <option value="deep">Deep (All ports)</option>
                    </select>
                </div>
                <button id="startScanBtn" class="btn btn-primary" style="height: 48px;">
                    Start Scan
                </button>
            </div>

            <!-- Progress Bar -->
            <div id="scanProgressContainer" style="display: none; margin-top: 1.5rem;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span style="color: var(--neon-lime); font-size: 0.9rem;" id="scanStatus">Scanning...</span>
                    <span style="color: var(--text-secondary); font-size: 0.9rem;" id="scanProgress">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                </div>
            </div>
        </div>

        <!-- Findings Summary -->
        <div id="findingsSummary" class="card slide-in-right" style="margin-bottom: 2rem; display: none;">
            <h3 style="margin-bottom: 1rem;">Recent Findings</h3>
            <div id="findingsList"></div>
        </div>

        <!-- Devices Table -->
        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h2>Discovered Devices</h2>
                <div style="display: flex; gap: 1rem;">
                    <input
                        type="text"
                        id="searchInput"
                        class="input-field"
                        placeholder="Search devices..."
                        style="width: 250px;"
                    >
                    <button id="refreshBtn" class="btn btn-primary">Refresh</button>
                </div>
            </div>

            <!-- Connection Status -->
            <div id="wsStatus" style="margin-bottom: 1rem; padding: 0.75rem; background: var(--bg-tertiary); border-radius: 4px; display: flex; align-items: center; gap: 0.5rem;">
                <span class="status-dot" id="wsStatusDot"></span>
                <span style="color: var(--text-secondary); font-size: 0.9rem;" id="wsStatusText">Connecting to live updates...</span>
            </div>

            <!-- Devices Table -->
            <div style="overflow-x: auto;">
                <table class="table" id="devicesTable">
                    <thead>
                        <tr>
                            <th>Status</th>
                            <th>IP Address</th>
                            <th>Hostname</th>
                            <th>MAC Address</th>
                            <th>Vendor</th>
                            <th>Open Ports</th>
                            <th>Risk Level</th>
                            <th>Last Seen</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="devicesTableBody">
                        <tr>
                            <td colspan="9" style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                                No devices found. Start a scan to discover devices.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="/js/config.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/api-client.js"></script>
    <script src="/js/websocket-client.js"></script>
    <script src="/js/pages/dashboard.js"></script>
</body>
</html>
